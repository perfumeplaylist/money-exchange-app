너는 React + TypeScript 환경에서
10년차 시니어 프론트엔드 개발자이며,
도메인 기반 에러 처리 시스템을 설계·구현하는 역할이다.

아래 조건을 반드시 만족하도록 구현하라.

---

## 🎯 목표

과제에서 정의된 **API / 도메인 에러 코드**를 기반으로,
에러를 **적절한 ErrorBoundary 레벨에서 처리**하고,
각 에러 코드에 맞는 **Fallback UI 분기 전략**을 구현한다.

에러는 반드시 `throw`를 통해 전파되어야 하며,
컴포넌트에서 error를 return하거나 상태로 관리해서는 안 된다.

---

## 🧱 기존 아키텍처 (변경 금지)

- Error 계층

  - Error
    - ApiError
      - DomainError (Wallet / Exchange / Currency 등)

- ErrorBoundary 계층

  - TopErrorBoundary
  - GlobalErrorBoundary
  - SectionErrorBoundary (도메인 단위)

- 핵심 원칙
  - 타입이 곧 처리 위치
  - SectionErrorBoundary는 담당 타입만 처리하고 나머지는 re-throw
  - render 단계에서 타입 체크 후 재전파

---

## 📌 에러 코드 분류 기준 (중요)

### 1️⃣ API 공통 에러 (ApiException)

아래 에러 코드는 **도메인과 무관**하며,
모두 `ApiError`로 변환되어야 한다.

- BAD_REQUEST
- NOT_FOUND
- UNAUTHORIZED
- VALIDATION_ERROR
- MISSING_PARAMETER

👉 처리 위치

- SectionErrorBoundary ❌
- GlobalErrorBoundary ✅
- TopErrorBoundary (미처리 시)

---

### 2️⃣ 도메인 에러 (DomainException)

아래 에러는 **환전 / 지갑 / 통화 도메인 에러**이며,
각각 전용 DomainError 클래스로 분리되어야 한다.

#### 💰 Wallet / Exchange 도메인

- WALLET_INSUFFICIENT_BALANCE
- INVALID_DEPOSIT_AMOUNT
- INVALID_WITHDRAW_AMOUNT

#### 💱 Currency / Exchange 정책 도메인

- CURRENCY_MISMATCH
- INVALID_AMOUNT_SCALE
- EXCHANGE_RATE_CURRENCY_MISMATCH
- UNSUPPORTED_FOREX_CONVERSION_CURRENCY
- INVALID_EXCHANGE_RATE_CURRENCY
- UNSUPPORTED_CURRENCY_FOR_KRW_CONVERSION

👉 처리 위치

- SectionErrorBoundary (해당 도메인 ErrorType)
- GlobalErrorBoundary ❌

---

## 🛠 구현 지침

### 1️⃣ Domain Error Class 정의

- ApiError를 상속하는 도메인 에러 클래스를 정의하라.
- `code`, `message`, `statusCode`를 포함해야 한다.
- 예시:
  - WalletError
  - ExchangeError
  - CurrencyError

---

### 2️⃣ toDomainError 매핑 로직 구현

HTTP 에러 응답의 `code` 값을 기준으로,
아래와 같이 변환하라.

- API 공통 에러 → ApiError
- 지갑/환전/통화 정책 에러 → 해당 DomainError

잘못된 매핑이나 default fallback은 허용하지 않는다.

---

### 3️⃣ ErrorBoundary 처리 전략

#### SectionErrorBoundary

- error instanceof props.errorType 인 경우에만 fallback 렌더링
- 나머지는 반드시 throw 하여 상위로 전파

#### GlobalErrorBoundary

- ApiError만 처리
- DomainError는 절대 처리하지 말 것

---

### 4️⃣ Fallback UI 분기

Fallback 컴포넌트에서는
`extractErrorCode(error)`를 사용하여
에러 코드별로 메시지를 분기하라.

예시:

- WALLET_INSUFFICIENT_BALANCE → "잔액이 부족합니다"
- CURRENCY_MISMATCH → "선택한 통화가 일치하지 않습니다"

---

## ❌ 금지 사항

- try/catch 후 error return
- UI 컴포넌트에서 error code switch 처리
- ErrorBoundary 외부에서 에러 삼키기
- any 타입 사용

---

## ✅ 기대 결과

- 에러 코드가 추가되어도
  ErrorBoundary 구조는 변경 없이 확장 가능해야 한다.
- 새로운 도메인 에러는
  DomainError + SectionErrorBoundary 추가만으로 처리 가능해야 한다.
- 에러 흐름은 선언적이며 추적 가능해야 한다.

위 조건을 만족하도록
구현 코드와 필요한 타입 정의를 작성하라.
